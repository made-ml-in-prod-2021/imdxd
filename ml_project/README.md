# ML Project

## Структура проекта
Проект состоит из следующих частей
- data
    - raw - данные из различных источников, для тренировки моделей, предсказаний и т.д.
    - proceed - Данные с предсказаниями
- experiments - Папка экспериментов, в каждом из них тренировочные и валидационные данные, модель и метрики
- notebooks - Папка для Jupyter ноутбуков с EDA
- reports - Папка с графиками и описательной статистикой из файла генерации отчетов
- src
    - configs - папка с кодом для config файлов
    - constants.py - константы для проекта (имена папок, распределение данных)
    - encoders.py - кастомный трансформер
    - evaluation.py - функции для предсказаний модели
    - pipelines.py - функции для создания, сохранения и загрузки моделей
    - process_data.py - функции обработки данных
- test
    - unit - unit тесты
    - e2e - end-to-end тесты
    - test_data - данные для тестов
    - generate_data.py - скрипт генерации данных для тестов
- eval_pipe.py - CLI для предсказания данных
- train_pipe.py - CLI для тренировки моделей
- generate_report.py - CLI для генерации описательной статистики по данным
- requirements.txt - внешние зависимости проекта
- README.md - описание проекта

## Обучение модели

Для обучения модели необходимо подготовить файл конфигурации

- raw_data: имя файла в data/raw_data
- experiment_name: имя эксперимента, должно быть уникально
- random_state: ядро генератора случайных чисел, для воспроизводимости
- label: имя таргета 
- splitting_params:
  - val_size: размер датасета для валидации в процентах
  - stratify: сохранять ли пропорцию таргета для валидации
- train_params:
  - model_type: тип модели из RandomForestClassifier, LogisticRegression, GradientBoostingClassifier
  - mean_alpha: параметр сглаживания для кодирования средним (натуральное число)
  - imput_strategy: стратегия заполнения пропусков: "mean", "median", "mode" 
- feature_params:
  - cat_cols: список категориальных колонок
  - real_cols: список действительных колонок
  - zero_cols: список колонок, для дополнительного признака, значение колонки == 0
    

`python train_pipe.py --config configs/{your_config}`

## Предсказания модели

- model: имя эксперимента из которого нужно взять модель
- raw_data: имя файла с данными в data/raw_data
- proceed_data: имя файла который будет сохранен в data/proceed_data
- threshold: отсечка положительного класса (от 0 до 1)

`python eval_pipe.py --config configs/{your_config}`

## Оценка

Стоит поставить 38 баллов потому что:
- Назовите ветку homework1 (1 балл) - done
- положите код в папку ml_project - done
- В описании к пулл реквесту описаны основные "архитектурные" и тактические решения, которые сделаны в вашей работе. В общем, описание что именно вы сделали и для чего, чтобы вашим ревьюерам было легче понять ваш код. (2 балла) - done
- Выполнение EDA, закоммитьте ноутбук в папку с ноутбуками (2 баллов) done
- Вы так же можете построить в ноутбуке прототип(если это вписывается в ваш тиль работы)
Можете использовать не ноутбук, а скрипт, который сгенерит отчет, закоммитьте и скрипт и отчет (за это + 1 балл) - done

- Проект имеет модульную структуру(не все в одном файле =) ) (2 баллов) - done
- использованы логгеры (2 балла) - done
- написаны тесты на отдельные модули и на прогон всего пайплайна(3 баллов) - done
- Для тестов генерируются синтетические данные, приближенные к реальным (3 баллов) - done
- Обучение модели конфигурируется с помощью конфигов в json или yaml, закоммитьте как минимум 2 корректные конфигурации, с помощью которых можно обучить модель (разные модели, стратегии split, preprocessing) (3 балла) - done
- Используются датаклассы для сущностей из конфига, а не голые dict (3 балла) - done 
- Используйте кастомный трансформер(написанный своими руками) и протестируйте его(3 балла) - done
- Обучите модель, запишите в readme как это предлагается (3 балла) - done
- напишите функцию predict, которая примет на вход артефакт/ы от обучения, тестовую выборку(без меток) и запишет предикт, напишите в readme как это сделать (3 балла) - done  

11) Используется hydra  (https://hydra.cc/docs/intro/) (3 балла - доп баллы)

12) Настроен CI(прогон тестов, линтера) на основе github actions  (3 балла - доп баллы (будем проходить дальше в курсе, но если есть желание поразбираться - welcome)
- Проведите самооценку, опишите, в какое колво баллов по вашему мнению стоит оценить вашу работу и почему (1 балл доп баллы) done 